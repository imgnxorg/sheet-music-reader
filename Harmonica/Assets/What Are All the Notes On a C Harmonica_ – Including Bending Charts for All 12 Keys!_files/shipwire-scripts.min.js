"use strict";(function(a){a(document).on("EDD_Payment_Gateway_Shipping_Fields_Scripts_Done",function(){var c=a("#edd_purchase_form");var d=a(c).find("#shipwire_shipping_options");if(d[0]){new b}});function b(){var b=false;var c=a("#edd_purchase_form_wrap");var d=a(c).find(".ajax-loading");a(d).hide();p();u();e();f();function e(){a(c).find(".button-get-shipping-rates").on("click",function(){var a=i();if(a){n(a)}})}function f(){a("#shipwire_carriers").on("change",function(){var b=a(this).find("input[type=radio]:checked");var c=b.data("price");o(c)})}function g(){a("#edd_checkout_cart_form .edd-item-quantity").off("change.monitor").one("change.monitor",function(){p();t()})}function h(){var b=[".edd-stripe-existing-card","#edd-stripe-update-billing-address","#use_different_shipping","#existing_shipping_address","#card_address","#card_address_2","#card_city","#card_zip","#billing_country","#card_state","#shipping_address","#shipping_address_2","#shipping_city","#shipping_zip","#shipping_country","#shipping_state_other","#shipping_state_us","#shipping_state_ca","#shipping_state_au"];a(c).find(b.join(",")).off("change.monitor").one("change.monitor",function(){p();t()})}function i(){var b={address1:null,address2:null,city:null,postalCode:null,country:null,state:null,use_existing_shipping_address:null,existingShippingAddressKey:null,use_existing_card:null,existingCardToken:null};if(j()){if(k()){w();b["address1"]=a(c).find("#shipping_address").val();if(!b["address1"]){return false}b["address2"]=a(c).find("#shipping_address_2").val();b["city"]=a(c).find("#shipping_city").val();if(!b["city"]){return false}b["postalCode"]=a(c).find("#shipping_zip").val();if(!b["postalCode"]){return false}b["country"]=a(c).find("#shipping_country").val();if(!b["country"]){return false}b["state"]=a(c).find(".shipping-state:visible").val();if(!b["state"]){return false}}else{b["use_existing_shipping_address"]=true;b["existingShippingAddressKey"]=a(c).find("#existing_shipping_address").val();if(b["existingShippingAddressKey"]===undefined){return false}}}else{if(l()||m()){v();b["address1"]=a(c).find("#card_address").val();if(!b["address1"]){return false}b["address2"]=a(c).find("#card_address_2").val();b["city"]=a(c).find("#card_city").val();if(!b["city"]){return false}b["postalCode"]=a(c).find("#card_zip").val();if(!b["postalCode"]){return false}b["country"]=a(c).find("#billing_country").val();if(!b["country"]){return false}b["state"]=a(c).find("#card_state").val();if(!b["state"]){return false}}else{b["use_existing_card"]=true;var d=a(c).find(".existing-card-wrapper.selected");b["existingCardToken"]=a(d).find("input.edd-stripe-existing-card").val();if(!b["existingCardToken"]){return false}}}return b}function j(){var b=a(c).find("#use_different_shipping");if(b[0]){return b.prop("checked")}else{return true}}function k(){var b=a(c).find("#existing_shipping_address");if(b[0]){return a(b[0]).val()==="new"}else{return true}}function l(){var b=a(c).find("#edd-stripe-add-new");return b[0]?b.prop("checked"):true}function m(){var b=a(c).find("#edd-stripe-update-billing-address");return b[0]?b.prop("checked"):true}function n(c){b=false;g();h();r();p();a(d).show();var e=a("#shipwire_carriers");a(e).html("");a.ajax({type:"POST",dataType:"JSON",url:theme_shipwire_module_obj.ajaxurl,data:{action:"get-shipwire-carrier-options",security:theme_shipwire_module_obj.nonce,address1:c["address1"],address2:c["address2"],city:c["city"],postalCode:c["postalCode"],country:c["country"],state:c["state"],use_existing_shipping_address:c["use_existing_shipping_address"],existingShippingAddressKey:c["existingShippingAddressKey"],use_existing_card:c["use_existing_card"],existingCardToken:c["existingCardToken"]},success:function success(c){if(c["code"]===200){if(b){return}a(e).html(c["html"]);a(e).show()}},complete:function complete(){a(d).hide();s()}})}function o(b){g();h();p();a.ajax({type:"POST",dataType:"json",url:theme_shipwire_module_obj.ajaxurl,data:{action:"update-cart-shipping-fee",security:theme_shipwire_module_obj.nonce,feeAmount:b},success:function success(b){a("#edd_checkout_cart").replaceWith(b.html);a(".edd_cart_amount").each(function(){a(this).text(b.total)});if(b["code"]===200){q()}},complete:function complete(){}})}function p(){var b=a("#edd-purchase-button");b.prop("disabled",true);b.addClass("disabled")}function q(){var b=a("#edd-purchase-button");b.prop("disabled",false);b.removeClass("disabled")}function r(){var b=a(".button-get-shipping-rates");b.prop("disabled",true);b.addClass("disabled")}function s(){var b=a(".button-get-shipping-rates");b.prop("disabled",false);b.removeClass("disabled")}function t(){var c=a(".shipwire-notice");if(!c.length){var e=a("#shipwire_carriers");a(d).hide();a(e).html("<p class=\"shipwire-notice\">Please recalculate the shipping rate.</p>")}b=true}function u(){a("#shipwire_shipping_options .circle-tag .num").html("<i class=\"fas fa-shipping-fast\"></i>")}function v(){var b=a(c).find("#card_address, #card_city, #card_zip, #billing_country, #card_state");a(b).each(function(){a(this).trigger("_validate_input")});a(c).trigger("_scroll_to_error")}function w(){var b=a(c).find("#shipping_address, #shipping_city, #shipping_zip, #shipping_country, .shipping-state:visible");a(b).each(function(){a(this).trigger("_validate_input")});a(c).trigger("_scroll_to_error")}}})(jQuery);
//# sourceMappingURL=shipwire-scripts.min.js.map